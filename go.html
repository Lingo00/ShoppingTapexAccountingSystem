<html><head><base href="https://www.husscosteel.com/"><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>نظام التكاليف | Cost Accounting System</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
@import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap');

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: 'Cairo', sans-serif;
}

body {
  direction: rtl;
  background: #f8f9fa; /* Lighter gray background */
}

.sidebar {
  height: 100%;
  width: 0;
  position: fixed;
  z-index: 1;
  top: 0;
  right: 0;
  background-color: #f4a261; /* Light orange - primary color */
  overflow-x: hidden;
  transition: 0.5s;
  padding-top: 60px;
}

.sidebar a {
  padding: 10px 25px;
  text-decoration: none;
  font-size: 16px;
  color: #fff;
  display: block;
  transition: 0.3s;
}

.sidebar .submenu {
  display: none;
  background-color: #e9c46a; /* Slightly lighter orange for contrast */
  padding-right: 20px;
}

.sidebar .submenu a {
  font-size: 14px;
  padding: 8px 25px;
}

.sidebar a:hover {
  background-color: #e9c46a;
}

.sidebar .submenu a:hover {
  background-color: #f4a261;
}

.sidebar .closebtn {
  position: absolute;
  top: 0;
  left: 25px;
  font-size: 36px;
}

.sidebar .menu-section {
  border-bottom: 1px solid #e9c46a;
  padding: 10px 0;
}

.menu-item {
  position: relative;
}

.menu-item.active .submenu {
  display: block;
}

.menu-item > a::after {
  content: '▼';
  position: absolute;
  left: 15px;
  transition: transform 0.3s;
}

.menu-item.active > a::after {
  transform: rotate(180deg);
}

.hamburger {
  font-size: 30px;
  cursor: pointer;
  position: fixed;
  top: 20px;
  right: 20px;
  background: #f4a261; /* Match sidebar color */
  padding: 10px 15px;
  border-radius: 5px;
  color: white;
  z-index: 2;
}

.sidebar::-webkit-scrollbar {
  width: 5px;
}

.sidebar::-webkit-scrollbar-track {
  background: #f4a261; /* Light orange track */
}

.sidebar::-webkit-scrollbar-thumb {
  background: #e9c46a; /* Light orange thumb */
}

.main-content {
  margin-right: 0;
  padding: 20px;
  transition: 0.5s;
}

.main-content.shifted {
  margin-right: 250px;
}

.kpi-container {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 20px;
  margin-top: 100px;
  padding: 20px;
}

.kpi-card {
  background: #ffffff; /* Pure white */
  border-radius: 10px;
  padding: 20px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.05);
  text-align: center;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.kpi-card:hover {
  transform: translateY(-3px);
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}

.kpi-title {
  color: #1a365d; /* Changed from #f4a261 to dark navy */
  font-size: 16px;
  margin-bottom: 10px;
}

.kpi-value {
  color: #1a365d; /* Changed from #f4a261 to dark navy */
  font-size: 24px;
  font-weight: bold;
}

.charts-container {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
  gap: 20px;
  margin-top: 20px;
  padding: 20px;
}

.chart-card {
  background: #ffffff; /* Pure white */
  border-radius: 10px;
  padding: 20px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.05);
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.chart-card:hover {
  transform: translateY(-3px);
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}

/* Adding new styles for notifications and search */
.notification-panel {
  position: fixed;
  left: 20px;
  top: 20px;
  width: 300px;
  background: #ffffff; /* Pure white */
  border-radius: 10px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.05);
  z-index: 1000;
  transform: translateX(0);
  transition: transform 0.3s ease-in-out;
}

.notification-panel.hidden {
  transform: translateX(-330px);
}

.notification-header {
  background: #f4a261; /* Light orange */
  color: white;
  padding: 15px;
  border-radius: 10px 10px 0 0;
  display: flex;
  justify-content: space-between;
  align-items: center;
  position: relative;
}

.notification-close {
  position: absolute;
  left: 10px;
  top: 50%;
  transform: translateY(-50%);
  cursor: pointer;
  color: white;
  padding: 5px;
}

.notification-close:hover {
  opacity: 0.8;
}

.notification-list {
  max-height: 300px;
  overflow-y: auto;
  padding: 0;
}

.notification-item {
  padding: 15px;
  border-bottom: 1px solid #f0f0f0; /* Lighter border */
  display: flex;
  align-items: center;
  gap: 10px;
  background: #ffffff; /* Pure white */
}

.notification-item.urgent {
  background-color: #fff5f5; /* Very light red background */
  border-right: 3px solid #c0392b; /* Darker red for urgent */
}

.notification-icon {
  width: 20px;
  height: 20px;
  fill: #f4a261; /* Light orange */
}

.search-container {
  position: fixed;
  top: 20px;
  left: 340px;
  right: 80px;
  z-index: 1000;
}

.search-bar {
  width: 100%;
  padding: 12px 20px;
  border: none;
  border-radius: 5px;
  background: #ffffff; /* Pure white */
  box-shadow: 0 2px 5px rgba(0,0,0,0.05);
  font-size: 14px;
  direction: rtl;
}

.search-bar:focus {
  outline: none;
  box-shadow: 0 2px 10px rgba(0,0,0,0.2);
}

/* Add styles for notifications toggle button */
.notifications-toggle {
  position: fixed;
  left: 20px;
  top: 20px;
  background: #f4a261; /* Light orange */
  color: white;
  padding: 10px 15px;
  border-radius: 5px;
  cursor: pointer;
  z-index: 999;
  transition: 0.3s;
}

.notifications-toggle:hover {
  background: #e9c46a; /* Darker orange on hover */
}

/* Add new styles for activity log */
.activity-log {
  background: #ffffff; /* Pure white */
  border-radius: 10px;
  padding: 20px;
  margin: 20px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.05);
}

.activity-log-header {
  color: #1a365d; /* Changed from #f4a261 to dark navy */
  font-size: 18px;
  margin-bottom: 15px;
  padding-bottom: 10px;
  border-bottom: 2px solid #eee;
}

.activity-item {
  display: flex;
  align-items: center;
  padding: 12px 0;
  border-bottom: 1px solid #eee;
  transition: transform 0.2s ease;
}

.activity-item:hover {
  transform: translateX(-5px);
  background: #fafafa;
}

.activity-icon {
  width: 30px;
  height: 30px;
  margin-left: 15px;
  padding: 6px;
  border-radius: 50%;
  background: #f8f9fa; /* Light gray background */
  fill: #f4a261; /* Light orange */
}

.activity-details {
  flex-grow: 1;
}

.activity-title {
  font-weight: bold;
  color: #1a365d; /* Changed from #f4a261 to dark navy */
  margin-bottom: 4px;
}

.activity-time {
  color: #95a5a6;
  font-size: 0.9em;
}

.activity-type {
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 0.8em;
  margin-right: auto;
  color: #1a365d; /* Changed color to dark navy */
}

.type-journal {
  background: #f8f9fa; /* Light gray background */
}

.type-cost-center {
  background: #f8f9fa; /* Matching light background */
}

/* Add new footer styles */
.footer {
  background: #ffffff;
  padding: 20px;
  text-align: center;
  margin-top: 40px;
  border-top: 1px solid #eee;
  color: #1a365d;
}

.footer a {
  color: #f4a261;
  text-decoration: none;
}

.footer a:hover {
  text-decoration: underline;
}

/* Add loading animation */
@keyframes shimmer {
  0% { background-position: -1000px 0; }
  100% { background-position: 1000px 0; }
}

.loading {
  background: linear-gradient(90deg, #f0f0f0 25%, #f8f8f8 50%, #f0f0f0 75%);
  background-size: 1000px 100%;
  animation: shimmer 2s infinite linear;
}
</style>
</head>
<body>

<!-- Add toggle button -->
<div class="notifications-toggle" onclick="toggleNotifications()">
  <svg width="20" height="20" viewBox="0 0 20 20" fill="white">
    <path d="M10 0C4.5 0 0 4.5 0 10s4.5 10 10 10 10-4.5 10-10S15.5 0 10 0zm0 18c-4.4 0-8-3.6-8-8s3.6-8 8-8 8 3.6 8 8-3.6 8-8 8z"/>
    <path d="M11 5H9v6h2V5zm0 8H9v2h2v-2z"/>
  </svg>
</div>

<div class="notification-panel hidden">
  <div class="notification-header">
    <span>التنبيهات والإشعارات</span>
    <span id="notification-count">3</span>
    <span class="notification-close" onclick="toggleNotifications()">×</span>
  </div>
  <div class="notification-list">
    <div class="notification-item urgent">
      <svg class="notification-icon" viewBox="0 0 20 20">
        <path d="M10 0C4.5 0 0 4.5 0 10s4.5 10 10 10 10-4.5 10-10S15.5 0 10 0zm0 18c-4.4 0-8-3.6-8-8s3.6-8 8-8 8 3.6 8 8-3.6 8-8 8zm0-13c-.6 0-1 .4-1 1v4c0 .6.4 1 1 1s1-.4 1-1V6c0-.6-.4-1-1-1zm0 8c-.6 0-1 .4-1 1s.4 1 1 1 1-.4 1-1-.4-1-1-1z"/>
      </svg>
      <div>
        <strong style="color: #1a365d;">تجاوز التكاليف المعيارية</strong>
        <p style="color: #2c4a7c;">تجاوزت التكاليف في قسم الإنتاج المعايير المحددة بنسبة 15%</p>
      </div>
    </div>
    <div class="notification-item">
      <svg class="notification-icon" viewBox="0 0 20 20">
        <path d="M10 0C4.5 0 0 4.5 0 10s4.5 10 10 10 10-4.5 10-10S15.5 0 10 0zm0 18c-4.4 0-8-3.6-8-8s3.6-8 8-8 8 3.6 8 8-3.6 8-8 8zm-1-13h2v6H9V5zm0 8h2v2H9v-2z"/>
      </svg>
      <div>
        <strong style="color: #1a365d;">طلب موافقة جديد</strong>
        <p style="color: #2c4a7c;">طلب اعتماد تكاليف إضافية لمشروع التوسعة</p>
      </div>
    </div>
    <div class="notification-item">
      <svg class="notification-icon" viewBox="0 0 20 20">
        <path d="M10 0C4.5 0 0 4.5 0 10s4.5 10 10 10 10-4.5 10-10S15.5 0 10 0zm0 18c-4.4 0-8-3.6-8-8s3.6-8 8-8 8 3.6 8 8-3.6 8-8 8zm-1-13h2v6H9V5zm0 8h2v2H9v-2z"/>
      </svg>
      <div>
        <strong style="color: #1a365d;">تقرير جديد</strong>
        <p style="color: #2c4a7c;">تم إصدار تقرير التكاليف الشهري لشهر يونيو</p>
      </div>
    </div>
  </div>
</div>

<div class="search-container">
  <input type="search" class="search-bar" placeholder="ابحث عن مراكز التكلفة، التقارير، المعاملات..." />
</div>

<div class="hamburger" onclick="toggleNav()">☰</div>

<div id="mySidebar" class="sidebar">
  <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">×</a>
  <div class="menu-section">
    <div class="menu-item">
      <a href="javascript:void(0)" onclick="toggleSubmenu(this)" style="color: #1a365d;">إدارة حسابات التكاليف</a>
      <div class="submenu">
        <a href="https://www.husscosteel.com/cost-centers">مراكز التكلفة</a>
        <a href="https://www.husscosteel.com/direct-indirect-costs">التكاليف المباشرة وغير المباشرة</a>
      </div>
    </div>
    
    <div class="menu-item">
      <a href="javascript:void(0)" onclick="toggleSubmenu(this)" style="color: #1a365d;">تسجيل وتوزيع التكاليف</a>
      <div class="submenu">
        <a href="https://www.husscosteel.com/primary-costs">التكاليف الأولية</a>
        <a href="https://www.husscosteel.com/indirect-manufacturing">التكاليف الصناعية غير المباشرة</a>
        <a href="https://www.husscosteel.com/cost-allocation">توزيع التكاليف</a>
      </div>
    </div>

    <div class="menu-item">
      <a href="javascript:void(0)" onclick="toggleSubmenu(this)" style="color: #1a365d;">تحليل التكلفة</a>
      <div class="submenu">
        <a href="https://www.husscosteel.com/product-cost">تكلفة المنتج</a>
        <a href="https://www.husscosteel.com/variance-analysis">تحليل الانحرافات</a>
        <a href="https://www.husscosteel.com/break-even">تحليل نقطة التعادل</a>
      </div>
    </div>

    <div class="menu-item">
      <a href="javascript:void(0)" onclick="toggleSubmenu(this)" style="color: #1a365d;">إعداد التقارير</a>
      <div class="submenu">
        <a href="https://www.husscosteel.com/detailed-cost-reports">تقارير التكاليف التفصيلية</a>
        <a href="https://www.husscosteel.com/performance-reports">تقارير الأداء</a>
        <a href="https://www.husscosteel.com/variance-reports">تقارير الانحرافات</a>
      </div>
    </div>

    <div class="menu-item">
      <a href="javascript:void(0)" onclick="toggleSubmenu(this)" style="color: #1a365d;">إدارة المخزون والتكاليف المرتبطة</a>
      <div class="submenu">
        <a href="https://www.husscosteel.com/inventory-analysis">تحليل المخزون</a>
        <a href="https://www.husscosteel.com/order-management">إدارة الطلبات</a>
      </div>
    </div>

    <div class="menu-item">
      <a href="javascript:void(0)" onclick="toggleSubmenu(this)" style="color: #1a365d;">التكامل مع الأنظمة الأخرى</a>
      <div class="submenu">
        <a href="https://www.husscosteel.com/production-integration">التكامل مع الإنتاج</a>
        <a href="https://www.husscosteel.com/sales-integration">التكامل مع المبيعات</a>
        <a href="https://www.husscosteel.com/management-integration">التكامل مع الإدارة العامة</a>
      </div>
    </div>

    <div class="menu-item">
      <a href="javascript:void(0)" onclick="toggleSubmenu(this)" style="color: #1a365d;">دعم التكاليف المعيارية</a>
      <div class="submenu">
        <a href="https://www.husscosteel.com/standard-costs">تحديد التكاليف المعيارية</a>
        <a href="https://www.husscosteel.com/actual-vs-standard">مقارنة الفعلية بالمعيارية</a>
      </div>
    </div>

    <div class="menu-item">
      <a href="javascript:void(0)" onclick="toggleSubmenu(this)" style="color: #1a365d;">أتمتة العمليات المحاسبية</a>
      <div class="submenu">
        <a href="https://www.husscosteel.com/automatic-calculation">حساب التكاليف تلقائيًا</a>
        <a href="https://www.husscosteel.com/dynamic-reports">إعداد التقارير الديناميكية</a>
      </div>
    </div>

    <div class="menu-item">
      <a href="javascript:void(0)" onclick="toggleSubmenu(this)" style="color: #1a365d;">واجهة المستخدم والتقارير التفاعلية</a>
      <div class="submenu">
        <a href="https://www.husscosteel.com/interactive-dashboard">لوحة تحكم تفاعلية</a>
      </div>
    </div>

    <div class="menu-item">
      <a href="javascript:void(0)" onclick="toggleSubmenu(this)" style="color: #1a365d;">الأمان والصلاحيات</a>
      <div class="submenu">
        <a href="https://www.husscosteel.com/user-permissions">إدارة صلاحيات المستخدمين</a>
        <a href="https://www.husscosteel.com/data-backup">النسخ الاحتياطي للبيانات</a>
      </div>
    </div>
  </div>
</div>

<div class="main-content" id="mainContent">
  <div class="kpi-container">
    <div class="kpi-card">
      <h3 class="kpi-title">إجمالي التكاليف المباشرة وغير المباشرة</h3>
      <div class="kpi-value">1,250,000 ر.س</div>
    </div>
    
    <div class="kpi-card">
      <h3 class="kpi-title">إجمالي الإيرادات</h3>
      <div class="kpi-value">2,500,000 ر.س</div>
    </div>
    
    <div class="kpi-card">
      <h3 class="kpi-title">التكاليف لكل مركز تكلفة</h3>
      <div class="kpi-value">450,000 ر.س</div>
    </div>
    
    <div class="kpi-card">
      <h3 class="kpi-title">نقطة التعادل</h3>
      <div class="kpi-value">850,000 ر.س</div>
    </div>
  </div>

  <div class="charts-container">
    <div class="chart-card">
      <canvas id="costDistribution"></canvas>
    </div>
    <div class="chart-card">
      <canvas id="costRevenueTrend"></canvas>
    </div>
  </div>
  
  <!-- Add Activity Log section -->
  <div class="activity-log">
    <h3 class="activity-log-header">آخر الأنشطة والعمليات</h3>
    
    <div class="activity-item">
      <svg class="activity-icon" viewBox="0 0 24 24" fill="#3498db"> <!-- Blue -->
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14z"/>
        <path d="M7 7h10v2H7zm0 4h10v2H7zm0 4h7v2H7z"/>
      </svg>
      <div class="activity-details">
        <div class="activity-title">إضافة قيد يومي جديد</div>
        <div class="activity-time">منذ 5 دقائق</div>
      </div>
      <span class="activity-type type-journal">قيد يومي</span>
    </div>

    <div class="activity-item">
      <svg class="activity-icon" viewBox="0 0 24 24" fill="#e67e22"> <!-- Orange -->
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14z"/>
        <path d="M7 12h4v4H7zm6-8h4v4h-4z"/>
      </svg>
      <div class="activity-details">
        <div class="activity-title">تعديل مركز تكلفة الإنتاج</div>
        <div class="activity-time">منذ 15 دقيقة</div>
      </div>
      <span class="activity-type type-cost-center">مركز تكلفة</span>
    </div>

    <div class="activity-item">
      <svg class="activity-icon" viewBox="0 0 24 24" fill="#3498db"> <!-- Blue -->
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14z"/>
        <path d="M7 7h10v2H7zm0 4h10v2H7zm0 4h7v2H7z"/>
      </svg>
      <div class="activity-details">
        <div class="activity-title">تسجيل مصروفات التشغيل</div>
        <div class="activity-time">منذ ساعة</div>
      </div>
      <span class="activity-type type-journal">قيد يومي</span>
    </div>

    <div class="activity-item">
      <svg class="activity-icon" viewBox="0 0 24 24" fill="#e67e22"> <!-- Orange -->
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14z"/>
        <path d="M7 12h4v4H7zm6-8h4v4h-4z"/>
      </svg>
      <div class="activity-details">
        <div class="activity-title">إنشاء مركز تكلفة جديد</div>
        <div class="activity-time">منذ ساعتين</div>
      </div>
      <span class="activity-type type-cost-center">مركز تكلفة</span>
    </div>
  </div>
</div>

<div class="footer">
  جميع الحقوق محفوظة © 2024 | تصميم وبرمجة 
  <a href="https://www.shoppingtopex.com" target="_blank">شركة شوبنق تابكس</a>
  | <span dir="ltr">777007199</span>
</div>

<script>
let sidebarOpen = false;

function toggleNav() {
  if (sidebarOpen) {
    closeNav();
  } else {
    openNav();
  }
}

function openNav() {
  document.getElementById("mySidebar").style.width = "250px";
  document.getElementById("mainContent").classList.add("shifted");
  sidebarOpen = true;
}

function closeNav() {
  document.getElementById("mySidebar").style.width = "0";
  document.getElementById("mainContent").classList.remove("shifted");
  sidebarOpen = false;
}

function toggleSubmenu(element) {
  const menuItem = element.parentElement;
  const wasActive = menuItem.classList.contains('active');
  
  document.querySelectorAll('.menu-item').forEach(item => {
    item.classList.remove('active');
  });
  
  if (!wasActive) {
    menuItem.classList.add('active');
  }
}

// Add KPI trend indicators
function updateKPITrends() {
  const kpiCards = document.querySelectorAll('.kpi-card');
  kpiCards.forEach(card => {
    const trend = document.createElement('div');
    trend.className = 'kpi-trend';
    trend.innerHTML = `
      <svg width="16" height="16" viewBox="0 0 16 16" fill="#2ecc71">
        <path d="M8 4l4 4H4z"/>
      </svg>
      <span style="color: #2ecc71">+5.2%</span>
    `;
    card.appendChild(trend);
  });
}

document.addEventListener('DOMContentLoaded', function() {
  updateKPITrends();
  
  // Charts initialization
  // Cost Distribution Pie Chart
  const costDistribution = new Chart(document.getElementById('costDistribution'), {
    type: 'pie',
    data: {
      labels: ['المواد', 'العمالة', 'التكاليف غير المباشرة'],
      datasets: [{
        data: [45, 30, 25],
        backgroundColor: ['#f4a261', '#e9c46a', '#ffd7ba'] /* Different shades of orange */
      }]
    },
    options: {
      responsive: true,
      plugins: {
        title: {
          display: true,
          text: 'توزيع التكاليف',
          font: {
            size: 16,
            family: 'Cairo'
          }
        }
      }
    }
  });

  // Cost & Revenue Trend Line Chart
  const costRevenueTrend = new Chart(document.getElementById('costRevenueTrend'), {
    type: 'line',
    data: {
      labels: ['يناير', 'فبراير', 'مارس', 'أبريل', 'مايو', 'يونيو'],
      datasets: [{
        label: 'التكاليف',
        data: [650000, 700000, 850000, 900000, 950000, 1000000],
        borderColor: '#f4a261', /* Light orange for costs */
        fill: false
      }, {
        label: 'الإيرادات',
        data: [800000, 950000, 1100000, 1250000, 1400000, 1600000],
        borderColor: '#e9c46a', /* Lighter orange for revenue */
        fill: false
      }]
    },
    options: {
      responsive: true,
      plugins: {
        title: {
          display: true,
          text: 'تطور التكاليف والإيرادات',
          font: {
            size: 16,
            family: 'Cairo'
          }
        }
      }
    }
  });

  // Add error handling to chart loading
  window.addEventListener('error', function(e) {
    if(e.target.tagName === 'CANVAS') {
      showError('خطأ في تحميل الرسم البياني');
    }
  });
});

// Add search functionality
document.querySelector('.search-bar').addEventListener('input', function(e) {
  const searchTerm = e.target.value.toLowerCase();
  console.log('Searching for:', searchTerm);
});

// Add notification functionality
let notifications = document.querySelectorAll('.notification-item');
notifications.forEach(notification => {
  notification.addEventListener('click', function() {
    if (!this.classList.contains('read')) {
      this.classList.add('read');
      this.style.opacity = '0.7';
      updateNotificationCount();
    }
  });
});

function updateNotificationCount() {
  const unreadCount = document.querySelectorAll('.notification-item:not(.read)').length;
  document.getElementById('notification-count').textContent = unreadCount;
}

// Add notification toggling function
function toggleNotifications() {
  const panel = document.querySelector('.notification-panel');
  const toggle = document.querySelector('.notifications-toggle');
  
  if (panel.classList.contains('hidden')) {
    panel.classList.remove('hidden');
    toggle.style.display = 'none';
  } else {
    panel.classList.add('hidden'); 
    setTimeout(() => {
      toggle.style.display = 'block';
    }, 300); // Match transition duration
  }
}

// Add print function
function printReport() {
  const printContent = document.getElementById('mainContent').cloneNode(true);
  const charts = printContent.querySelectorAll('canvas');
  
  // Convert charts to images for printing
  Promise.all([...charts].map(canvas => {
    return new Promise(resolve => {
      const img = new Image();
      img.src = canvas.toDataURL();
      img.onload = () => {
        canvas.parentNode.replaceChild(img, canvas);
        resolve();
      };
    });
  })).then(() => {
    const win = window.open('', '', 'width=800,height=900');
    win.document.write(`
      <html>
        <head>
          <title>تقرير التكاليف</title>
          <style>
            @media print {
              body { font-family: 'Cairo', sans-serif; }
              .kpi-card { page-break-inside: avoid; }
            }
          </style>
        </head>
        <body>${printContent.innerHTML}</body>
      </html>
    `);
    win.document.close();
    win.print();
  });
}

// Add data export functionality
function exportData(type) {
  const data = {
    costs: costRevenueTrend.data,
    distribution: costDistribution.data
  };
  
  let content;
  if(type === 'json') {
    content = JSON.stringify(data);
  } else if(type === 'csv') {
    // Convert to CSV format
    content = 'Date,Costs,Revenue\n';
    data.costs.labels.forEach((label, i) => {
      content += `${label},${data.costs.datasets[0].data[i]},${data.costs.datasets[1].data[i]}\n`;
    });
  }
  
  const blob = new Blob([content], {type: 'text/plain'});
  const url = window.URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `cost-report.${type}`;
  a.click();
}

// Function to show loading overlay
function showLoading(element) {
  element.classList.add('loading');
}

function hideLoading(element) {
  element.classList.remove('loading');
}

function showError(message) {
  const alert = document.createElement('div');
  alert.className = 'error-alert';
  alert.textContent = message;
  document.body.appendChild(alert);
  setTimeout(() => alert.remove(), 3000);
}
</script>
</body>
</html>