<html><head><base href="https://www.husscosteel.com/"><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>نظام التكاليف | Cost Accounting System</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
@import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap');

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: 'Cairo', sans-serif;
}

body {
  direction: rtl;
  background: #f8f9fa; /* Lighter gray background */
  height: 100%;
  overflow-y: auto; /* Enable vertical scrolling */
  scroll-behavior: smooth; /* Add smooth scrolling */
}

.sidebar {
  height: 100vh; /* Change to viewport height */
  width: 0;
  position: fixed;
  z-index: 1;
  top: 0;
  right: 0;
  background-color: #f4a261; /* Light orange - primary color */
  overflow-y: auto; /* Enable scrolling in sidebar */
  -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
  transition: 0.5s;
  padding-top: 60px;
}

.sidebar a {
  padding: 10px 25px;
  text-decoration: none;
  font-size: 16px;
  color: #fff;
  display: block;
  transition: 0.3s;
}

.sidebar .submenu {
  display: none;
  background-color: #e9c46a; /* Slightly lighter orange for contrast */
  padding-right: 20px;
}

.sidebar .submenu a {
  font-size: 14px;
  padding: 8px 25px;
}

.sidebar a:hover {
  background-color: #e9c46a;
}

.sidebar .submenu a:hover {
  background-color: #f4a261;
}

.sidebar .closebtn {
  position: absolute;
  top: 0;
  left: 25px;
  font-size: 36px;
}

.sidebar .menu-section {
  border-bottom: 1px solid #e9c46a;
  padding: 10px 0;
}

.menu-item {
  position: relative;
}

.menu-item.active .submenu {
  display: block;
}

.menu-item > a::after {
  content: '▼';
  position: absolute;
  left: 15px;
  transition: transform 0.3s;
}

.menu-item.active > a::after {
  transform: rotate(180deg);
}

.hamburger {
  font-size: 30px;
  cursor: pointer;
  position: fixed;
  top: 20px;
  right: 20px;
  background: #f4a261; /* Match sidebar color */
  padding: 10px 15px;
  border-radius: 5px;
  color: white;
  z-index: 2;
}

.sidebar::-webkit-scrollbar {
  width: 5px;
}

.sidebar::-webkit-scrollbar-track {
  background: #f4a261; /* Light orange track */
}

.sidebar::-webkit-scrollbar-thumb {
  background: #e9c46a; /* Light orange thumb */
}

.main-content {
  margin-right: 0;
  padding: 20px;
  transition: 0.5s;
  min-height: 100vh; /* Ensure minimum full viewport height */
  overflow-y: auto; /* Enable scrolling */
}

.main-content.shifted {
  margin-right: 250px;
}

.kpi-container {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 20px;
  margin-top: 100px;
  padding: 20px;
}

.kpi-card {
  background: #ffffff; /* Pure white */
  border-radius: 10px;
  padding: 20px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.05);
  text-align: center;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.kpi-card:hover {
  transform: translateY(-3px);
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}

.kpi-title {
  color: #1a365d; /* Changed from #f4a261 to dark navy */
  font-size: 16px;
  margin-bottom: 10px;
}

.kpi-value {
  color: #1a365d; /* Changed from #f4a261 to dark navy */
  font-size: 24px;
  font-weight: bold;
}

.charts-container {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
  gap: 20px;
  margin-top: 20px;
  padding: 20px;
}

.chart-card {
  background: #ffffff; /* Pure white */
  border-radius: 10px;
  padding: 20px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.05);
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.chart-card:hover {
  transform: translateY(-3px);
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}

/* Adding new styles for notifications and search */
.notification-panel {
  position: fixed;
  left: 20px;
  top: 20px;
  width: 300px;
  background: #ffffff; /* Pure white */
  border-radius: 10px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.05);
  z-index: 1000;
  transform: translateX(0);
  transition: transform 0.3s ease-in-out;
}

.notification-panel.hidden {
  transform: translateX(-330px);
}

.notification-header {
  background: #f4a261; /* Light orange */
  color: white;
  padding: 15px;
  border-radius: 10px 10px 0 0;
  display: flex;
  justify-content: space-between;
  align-items: center;
  position: relative;
}

.notification-close {
  position: absolute;
  left: 10px;
  top: 50%;
  transform: translateY(-50%);
  cursor: pointer;
  color: white;
  padding: 5px;
}

.notification-close:hover {
  opacity: 0.8;
}

.notification-list {
  max-height: 300px;
  overflow-y: auto;
  padding: 0;
}

.notification-item {
  padding: 15px;
  border-bottom: 1px solid #f0f0f0; /* Lighter border */
  display: flex;
  align-items: center;
  gap: 10px;
  background: #ffffff; /* Pure white */
  transform: translateX(0);
  transition: transform 0.3s ease, opacity 0.3s ease, background-color 0.3s ease;
}

.notification-item:hover {
  transform: translateX(-10px);
  background-color: #f8f9fa;
}

.notification-item.read {
  opacity: 0.7;
}

.notification-item.urgent {
  background-color: #fff5f5; /* Very light red background */
  border-right: 3px solid #c0392b; /* Darker red for urgent */
}

.notification-icon {
  width: 20px;
  height: 20px;
  fill: #e74c3c; /* Change notification icons to red as well */
}

.search-container {
  position: fixed;
  top: 20px;
  left: 50%;
  transform: translateX(-50%);
  width: 50%; /* Reduce from previous width */
  max-width: 600px; /* Keep maximum width */
  min-width: 300px; /* Keep minimum width */
  z-index: 1000;
  transition: width 0.3s ease;
}

@media (max-width: 768px) {
  .search-container {
    width: 80%; /* Reduce from 90% */
  }
}

.search-bar {
  width: 100%;
  padding: 10px 15px; /* Reduce padding from 12px 20px */
  border: none;
  border-radius: 5px;
  background: #ffffff; /* Pure white */
  box-shadow: 0 2px 5px rgba(0,0,0,0.05);
  font-size: 13px; /* Reduce font size from 14px */
  direction: rtl;
}

.search-bar:focus {
  outline: none;
  box-shadow: 0 2px 10px rgba(0,0,0,0.2);
}

/* Add styles for notifications toggle button */
.notifications-toggle {
  position: fixed;
  left: 20px;
  top: 20px;
  background: #f4a261; /* Light orange */
  color: white;
  padding: 10px 15px;
  border-radius: 5px;
  cursor: pointer;
  z-index: 999;
  transition: 0.3s;
}

.notifications-toggle:hover {
  background: #e9c46a; /* Darker orange on hover */
}

.notifications-toggle svg {
  fill: #e74c3c; /* Change to red color */
}

/* Add new styles for activity log */
.activity-log {
  background: #ffffff; /* Pure white */
  border-radius: 10px;
  padding: 20px;
  margin: 20px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.05);
}

.activity-log-header {
  color: #1a365d; /* Changed from #f4a261 to dark navy */
  font-size: 18px;
  margin-bottom: 15px;
  padding-bottom: 10px;
  border-bottom: 2px solid #eee;
}

.activity-item {
  display: flex;
  align-items: center;
  padding: 12px 0;
  border-bottom: 1px solid #eee;
  transition: transform 0.2s ease;
}

.activity-item:hover {
  transform: translateX(-5px);
  background: #fafafa;
}

.activity-icon {
  width: 30px;
  height: 30px;
  margin-left: 15px;
  padding: 6px;
  border-radius: 50%;
  background: #f8f9fa; /* Light gray background */
  fill: #f4a261; /* Light orange */
}

.activity-details {
  flex-grow: 1;
}

.activity-title {
  font-weight: bold;
  color: #1a365d; /* Changed from #f4a261 to dark navy */
  margin-bottom: 4px;
}

.activity-time {
  color: #95a5a6;
  font-size: 0.9em;
}

.activity-type {
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 0.8em;
  margin-right: auto;
  color: #1a365d; /* Changed color to dark navy */
}

.type-journal {
  background: #f8f9fa; /* Light gray background */
}

.type-cost-center {
  background: #f8f9fa; /* Matching light background */
}

/* Add new footer styles */
.footer {
  background: #ffffff;
  padding: 20px;
  text-align: center;
  margin-top: 40px;
  border-top: 1px solid #eee;
  color: #1a365d;
}

.footer a {
  color: #f4a261;
  text-decoration: none;
}

.footer a:hover {
  text-decoration: underline;
}

/* Quick Actions Styles */
.quick-actions {
  display: flex;
  flex-wrap: wrap;
  gap: 15px;
  padding: 20px;
  margin-top: 100px;
  margin-bottom: 20px;
}

.quick-action-btn {
  display: flex;
  align-items: center;
  gap: 10px;
  background: #ffffff;
  padding: 15px 20px;
  border-radius: 8px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.05);
  cursor: pointer;
  transition: all 0.3s ease;
  border: none;
  color: #1a365d;
  font-family: 'Cairo', sans-serif;
}

.quick-action-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
  background: #f8f9fa;
}

.quick-action-btn svg {
  width: 20px;
  height: 20px;
  fill: #f4a261;
}

.quick-actions-section {
  width: 100%;
}

.quick-actions-title {
  color: #1a365d;
  font-size: 18px;
  margin-bottom: 15px;
  padding-right: 20px;
}

/* Add loading animation */
@keyframes shimmer {
  0% { background-position: -1000px 0; }
  100% { background-position: 1000px 0; }
}

.shimmer {
  background: linear-gradient(90deg, 
    #f0f0f0 0%, #f8f8f8 50%, #f0f0f0 100%);
  background-size: 200% 100%;
  animation: shimmer 1.5s infinite linear;
}

.loading {
  background: linear-gradient(90deg, #f0f0f0 25%, #f8f8f8 50%, #f0f0f0 75%);
  background-size: 1000px 100%;
  animation: shimmer 2s infinite linear;
}

/* Add new styles for AI button */
.ai-cost-button {
  position: fixed;
  bottom: 30px;
  left: 30px;
  background: #f4a261;
  color: #1a365d;
  padding: 15px 25px;
  border-radius: 50px;
  cursor: pointer;
  font-weight: bold;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  display: flex;
  align-items: center;
  gap: 10px;
  transition: all 0.3s ease;
  z-index: 1000;
}

.ai-cost-button:hover {
  transform: translateY(-3px);
  box-shadow: 0 6px 20px rgba(0,0,0,0.15);
  background: #e9c46a;
}

.ai-cost-button svg {
  width: 24px;
  height: 24px;
  fill: #1a365d;
}

/* Add styles for AI modal */
.ai-modal {
  display: none;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: white;
  padding: 30px;
  border-radius: 15px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.2);
  z-index: 1001;
  max-width: 500px;
  width: 90%;
}

/* New modal styles */
.modal-overlay {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0,0,0,0.5);
  z-index: 1001;
}

.modal, 
.modal-overlay {
  display: none;
}

.modal {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: white;
  padding: 30px;
  border-radius: 15px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.2);
  z-index: 1002;
  width: 90%;
  max-width: 600px;
  direction: rtl;
}

.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0,0,0,0.5);
  z-index: 1001;
}

.modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  padding-bottom: 10px;
  border-bottom: 1px solid #eee;
}

.modal-title {
  color: #1a365d;
  font-size: 1.5em;
  font-weight: bold;
}

.modal-close {
  cursor: pointer;
  font-size: 24px;
  color: #1a365d;
}

.form-group {
  margin-bottom: 20px;
}

.form-group label {
  display: block;
  margin-bottom: 8px;
  color: #1a365d;
}

.form-group input,
.form-group select,
.form-group textarea {
  width: 100%;
  padding: 10px;
  border: 1px solid #ddd;
  border-radius: 5px;
  font-family: 'Cairo', sans-serif;
}

.form-actions {
  display: flex;
  justify-content: flex-start;
  gap: 10px;
}

.btn-submit {
  background: #f4a261;
  color: #1a365d;
  padding: 10px 20px;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  font-family: 'Cairo', sans-serif;
}

.btn-cancel {
  background: #ddd;
  color: #1a365d;
  padding: 10px 20px;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  font-family: 'Cairo', sans-serif;
}

/* Add scroll-to-top button styles */
.scroll-to-top {
  position: fixed;
  bottom: 90px; /* Position above AI button */
  left: 30px;
  background: #f4a261;
  color: #1a365d;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  opacity: 0;
  transition: opacity 0.3s;
  z-index: 999;
}

.scroll-to-top.visible {
  opacity: 1;
}

.scroll-to-top:hover {
  background: #e9c46a;
}
</style>
</head>
<body>

<!-- Add toggle button -->
<div class="notifications-toggle" onclick="toggleNotifications()">
  <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
    <path d="M20 2v20l-4-4H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2h16zm-1 2H4v12h16V4zm-8 5v2H5V9h6zm5-2v6l-1.5-1.5V8.5L16 7z"/>
  </svg>
</div>

<div class="notification-panel hidden">
  <div class="notification-header">
    <span>التنبيهات والإشعارات</span>
    <span id="notification-count">3</span>
    <span class="notification-close" onclick="toggleNotifications()">×</span>
  </div>
  <div class="notification-list">
    <div class="notification-item urgent">
      <svg class="notification-icon" viewBox="0 0 20 20">
        <path d="M10 0C4.5 0 0 4.5 0 10s4.5 10 10 10 10-4.5 10-10S15.5 0 10 0zm0 18c-4.4 0-8-3.6-8-8s3.6-8 8-8 8 3.6 8 8-3.6 8-8 8zm0-13c-.6 0-1 .4-1 1v4c0 .6.4 1 1 1s1-.4 1-1V6c0-.6-.4-1-1-1zm0 8c-.6 0-1 .4-1 1s.4 1 1 1 1-.4 1-1-.4-1-1-1z"/>
      </svg>
      <div>
        <strong style="color: #1a365d;">تجاوز التكاليف المعيارية</strong>
        <p style="color: #2c4a7c;">تجاوزت التكاليف في قسم الإنتاج المعايير المحددة بنسبة 15%</p>
      </div>
    </div>
    <div class="notification-item">
      <svg class="notification-icon" viewBox="0 0 20 20">
        <path d="M10 0C4.5 0 0 4.5 0 10s4.5 10 10 10 10-4.5 10-10S15.5 0 10 0zm0 18c-4.4 0-8-3.6-8-8s3.6-8 8-8 8 3.6 8 8-3.6 8-8 8zm-1-13h2v6H9V5zm0 8h2v2H9v-2z"/>
      </svg>
      <div>
        <strong style="color: #1a365d;">طلب موافقة جديد</strong>
        <p style="color: #2c4a7c;">طلب اعتماد تكاليف إضافية لمشروع التوسعة</p>
      </div>
    </div>
    <div class="notification-item">
      <svg class="notification-icon" viewBox="0 0 20 20">
        <path d="M10 0C4.5 0 0 4.5 0 10s4.5 10 10 10 10-4.5 10-10S15.5 0 10 0zm0 18c-4.4 0-8-3.6-8-8s3.6-8 8-8 8 3.6 8 8-3.6 8-8 8zm-1-13h2v6H9V5zm0-4h5v2H9z"/>
      </svg>
      <div>
        <strong style="color: #1a365d;">تقرير جديد</strong>
        <p style="color: #2c4a7c;">تم إصدار تقرير التكاليف الشهري لشهر يونيو</p>
      </div>
    </div>
  </div>
</div>

<div class="search-container">
  <input type="search" class="search-bar" placeholder="ابحث عن مراكز التكلفة، التقارير، المعاملات..." />
</div>

<div class="quick-actions">
  <div class="quick-actions-section">
    <h3 class="quick-actions-title">العمليات السريعة</h3>
    <div style="display: flex; flex-wrap: wrap; gap: 15px;">
      <button class="quick-action-btn" onclick="openQuickAction('journal')">
        <svg viewBox="0 0 24 24">
          <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14z"/>
          <path d="M7 7h10v2H7zm0 4h10v2H7zm0 4h7v2H7z"/>
        </svg>
        تسجيل قيد يومي
      </button>

      <button class="quick-action-btn" onclick="openQuickAction('invoice')">
        <svg viewBox="0 0 24 24">
          <path d="M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 14H4V6h16v12z"/>
          <path d="M7 14h10v2H7zm0-4h10v2H7zm0-4h5v2H7z"/>
        </svg>
        إصدار فاتورة
      </button>

      <button class="quick-action-btn" onclick="openQuickAction('payment')">
        <svg viewBox="0 0 24 24">
          <path d="M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 14H4V6h16v12z"/>
          <path d="M12 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
        </svg>
        تسجيل دفعة
      </button>

      <button class="quick-action-btn" onclick="openQuickAction('expense')">
        <svg viewBox="0 0 24 24">
          <path d="M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4z"/>
        </svg>
        إضافة مصروف
      </button>
    </div>
  </div>

  <div class="quick-actions-section">
    <h3 class="quick-actions-title">التقارير السريعة</h3>
    <div style="display: flex; flex-wrap: wrap; gap: 15px;">
      <button class="quick-action-btn" onclick="openQuickAction('financial')">
        <svg viewBox="0 0 24 24">
          <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14z"/>
          <path d="M7 10h2v7H7zm4-3h2v10h-2zm4 6h2v4h-2z"/>
        </svg>
        التقارير المالية
      </button>

      <button class="quick-action-btn" onclick="openQuickAction('cashflow')">
        <svg viewBox="0 0 24 24">
          <path d="M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4z"/>
          <path d="M19 8l-4 4h3v4h2v-4h3l-4-4z"/>
        </svg>
        تقرير التدفقات النقدية
      </button>
    </div>
  </div>
</div>

<div class="hamburger" onclick="toggleNav()">☰</div>

<div id="mySidebar" class="sidebar">
  <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">×</a>
  <div class="menu-section">
    <div class="menu-item">
      <a href="javascript:void(0)" onclick="toggleSubmenu(this)" style="color: #1a365d;">إدارة حسابات التكاليف</a>
      <div class="submenu">
        <a href="https://www.husscosteel.com/cost-centers">مراكز التكلفة</a>
        <a href="https://www.husscosteel.com/direct-indirect-costs">التكاليف المباشرة وغير المباشرة</a>
      </div>
    </div>
    
    <div class="menu-item">
      <a href="javascript:void(0)" onclick="toggleSubmenu(this)" style="color: #1a365d;">تسجيل وتوزيع التكاليف</a>
      <div class="submenu">
        <a href="https://www.husscosteel.com/primary-costs">التكاليف الأولية</a>
        <a href="https://www.husscosteel.com/indirect-manufacturing">التكاليف الصناعية غير المباشرة</a>
        <a href="https://www.husscosteel.com/cost-allocation">توزيع التكاليف</a>
      </div>
    </div>

    <div class="menu-item">
      <a href="javascript:void(0)" onclick="toggleSubmenu(this)" style="color: #1a365d;">تحليل التكلفة</a>
      <div class="submenu">
        <a href="https://www.husscosteel.com/product-cost">تكلفة المنتج</a>
        <a href="https://www.husscosteel.com/variance-analysis">تحليل الانحرافات</a>
        <a href="https://www.husscosteel.com/break-even">تحليل نقطة التعادل</a>
      </div>
    </div>

    <div class="menu-item">
      <a href="javascript:void(0)" onclick="toggleSubmenu(this)" style="color: #1a365d;">إعداد التقارير</a>
      <div class="submenu">
        <a href="https://www.husscosteel.com/detailed-cost-reports">تقارير التكاليف التفصيلية</a>
        <a href="https://www.husscosteel.com/performance-reports">تقارير الأداء</a>
        <a href="https://www.husscosteel.com/variance-reports">تقارير الانحرافات</a>
      </div>
    </div>

    <div class="menu-item">
      <a href="javascript:void(0)" onclick="toggleSubmenu(this)" style="color: #1a365d;">إدارة المخزون والتكاليف المرتبطة</a>
      <div class="submenu">
        <a href="https://www.husscosteel.com/inventory-analysis">تحليل المخزون</a>
        <a href="https://www.husscosteel.com/order-management">إدارة الطلبات</a>
      </div>
    </div>

    <div class="menu-item">
      <a href="javascript:void(0)" onclick="toggleSubmenu(this)" style="color: #1a365d;">التكامل مع الأنظمة الأخرى</a>
      <div class="submenu">
        <a href="https://www.husscosteel.com/production-integration">التكامل مع الإنتاج</a>
        <a href="https://www.husscosteel.com/sales-integration">التكامل مع المبيعات</a>
        <a href="https://www.husscosteel.com/management-integration">التكامل مع الإدارة العامة</a>
      </div>
    </div>

    <div class="menu-item">
      <a href="javascript:void(0)" onclick="toggleSubmenu(this)" style="color: #1a365d;">دعم التكاليف المعيارية</a>
      <div class="submenu">
        <a href="https://www.husscosteel.com/standard-costs">تحديد التكاليف المعيارية</a>
        <a href="https://www.husscosteel.com/actual-vs-standard">مقارنة الفعلية بالمعيارية</a>
      </div>
    </div>

    <div class="menu-item">
      <a href="javascript:void(0)" onclick="toggleSubmenu(this)" style="color: #1a365d;">أتمتة العمليات المحاسبية</a>
      <div class="submenu">
        <a href="https://www.husscosteel.com/automatic-calculation">حساب التكاليف تلقائيًا</a>
        <a href="https://www.husscosteel.com/dynamic-reports">إعداد التقارير الديناميكية</a>
      </div>
    </div>

    <div class="menu-item">
      <a href="javascript:void(0)" onclick="toggleSubmenu(this)" style="color: #1a365d;">واجهة المستخدم والتقارير التفاعلية</a>
      <div class="submenu">
        <a href="https://www.husscosteel.com/interactive-dashboard">لوحة تحكم تفاعلية</a>
      </div>
    </div>

    <div class="menu-item">
      <a href="javascript:void(0)" onclick="toggleSubmenu(this)" style="color: #1a365d;">الأمان والصلاحيات</a>
      <div class="submenu">
        <a href="https://www.husscosteel.com/user-permissions">إدارة صلاحيات المستخدمين</a>
        <a href="https://www.husscosteel.com/data-backup">النسخ الاحتياطي للبيانات</a>
      </div>
    </div>
  </div>
</div>

<div class="main-content" id="mainContent">
  <div class="kpi-container">
    <div class="kpi-card">
      <h3 class="kpi-title">إجمالي التكاليف المباشرة وغير المباشرة</h3>
      <div class="kpi-value">1,250,000 ر.س</div>
    </div>
    
    <div class="kpi-card">
      <h3 class="kpi-title">إجمالي الإيرادات</h3>
      <div class="kpi-value">2,500,000 ر.س</div>
    </div>
    
    <div class="kpi-card">
      <h3 class="kpi-title">التكاليف لكل مركز تكلفة</h3>
      <div class="kpi-value">450,000 ر.س</div>
    </div>
    
    <div class="kpi-card">
      <h3 class="kpi-title">نقطة التعادل</h3>
      <div class="kpi-value">850,000 ر.س</div>
    </div>
  </div>

  <div class="charts-container">
    <div class="chart-card">
      <canvas id="costDistribution"></canvas>
    </div>
    <div class="chart-card">
      <canvas id="costRevenueTrend"></canvas>
    </div>
  </div>
  
  <!-- Add Activity Log section -->
  <div class="activity-log">
    <h3 class="activity-log-header">آخر الأنشطة والعمليات</h3>
    
    <div class="activity-item">
      <svg class="activity-icon" viewBox="0 0 24 24" fill="#3498db"> <!-- Blue -->
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14z"/>
        <path d="M7 7h10v2H7zm0 4h10v2H7zm0 4h7v2H7z"/>
      </svg>
      <div class="activity-details">
        <div class="activity-title">إضافة قيد يومي جديد</div>
        <div class="activity-time">منذ 5 دقائق</div>
      </div>
      <span class="activity-type type-journal">قيد يومي</span>
    </div>

    <div class="activity-item">
      <svg class="activity-icon" viewBox="0 0 24 24" fill="#e67e22"> <!-- Orange -->
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14z"/>
        <path d="M7 12h4v4H7zm6-8h4v4h-4z"/>
      </svg>
      <div class="activity-details">
        <div class="activity-title">تعديل مركز تكلفة الإنتاج</div>
        <div class="activity-time">منذ 15 دقيقة</div>
      </div>
      <span class="activity-type type-cost-center">مركز تكلفة</span>
    </div>

    <div class="activity-item">
      <svg class="activity-icon" viewBox="0 0 24 24" fill="#3498db"> <!-- Blue -->
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14z"/>
        <path d="M7 7h10v2H7zm0 4h10v2H7zm0 4h7v2H7z"/>
      </svg>
      <div class="activity-details">
        <div class="activity-title">تسجيل مصروفات التشغيل</div>
        <div class="activity-time">منذ ساعة</div>
      </div>
      <span class="activity-type type-journal">قيد يومي</span>
    </div>

    <div class="activity-item">
      <svg class="activity-icon" viewBox="0 0 24 24" fill="#e67e22"> <!-- Orange -->
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14z"/>
        <path d="M7 12h4v4H7zm6-8h4v4h-4z"/>
      </svg>
      <div class="activity-details">
        <div class="activity-title">إنشاء مركز تكلفة جديد</div>
        <div class="activity-time">منذ ساعتين</div>
      </div>
      <span class="activity-type type-cost-center">مركز تكلفة</span>
    </div>
  </div>
</div>

<button class="ai-cost-button" onclick="openAIModal()">
  <svg viewBox="0 0 24 24">
    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm2 8h-4v-2h4v2z"/>
  </svg>
  احسب التكاليف بالذكاء الاصطناعي
</button>

<div class="ai-modal-overlay" id="aiModalOverlay"></div>
<div class="ai-modal" id="aiModal">
  <h3 style="color: #1a365d; margin-bottom: 20px;">حساب التكاليف باستخدام الذكاء الاصطناعي</h3>
  <div style="margin-bottom: 20px;">
    <label style="display: block; margin-bottom: 10px; color: #1a365d;">ادخل تفاصيل المشروع:</label>
    <textarea id="projectDetails" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; height: 100px;"></textarea>
  </div>
  <button onclick="calculateAICosts()" style="background: #f4a261; color: #1a365d; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer;">حساب التكاليف</button>
  <button onclick="closeAIModal()" style="background: #ddd; color: #1a365d; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; margin-right: 10px;">إغلاق</button>
</div>

<!-- Journal Entry Modal -->
<div class="modal-overlay" id="journalEntryOverlay"></div>
<div class="modal" id="journalEntryModal">
  <div class="modal-header">
    <h3 class="modal-title">تسجيل قيد يومي جديد</h3>
    <span class="modal-close" onclick="closeJournalModal()">×</span>
  </div>
  
  <form id="journalEntryForm" onsubmit="submitJournalEntry(event)">
    <div class="form-group">
      <label>التاريخ</label>
      <input type="date" required>
    </div>
    
    <div class="form-group">
      <label>الوصف</label>
      <textarea rows="3" required></textarea>
    </div>
    
    <div class="form-group">
      <label>مركز التكلفة</label>
      <select required>
        <option value="">اختر مركز التكلفة</option>
        <option value="production">الإنتاج</option>
        <option value="sales">المبيعات</option>
        <option value="admin">الإدارة</option>
      </select>
    </div>
    
    <div class="form-group">
      <label>المبلغ</label>
      <input type="number" step="0.01" required>
    </div>
    
    <div class="form-group">
      <label>نوع القيد</label>
      <select required>
        <option value="">اختر نوع القيد</option>
        <option value="debit">مدين</option>
        <option value="credit">دائن</option>
      </select>
    </div>
    
    <div class="form-actions">
      <button type="submit" class="btn-submit">حفظ القيد</button>
      <button type="button" class="btn-cancel" onclick="closeJournalModal()">إلغاء</button>
    </div>
  </form>
</div>

<!-- Invoice Modal -->
<div class="modal-overlay" id="invoiceModalOverlay"></div>
<div class="modal" id="invoiceModal">
  <div class="modal-header">
    <h3 class="modal-title">إصدار فاتورة جديدة</h3>
    <span class="modal-close" onclick="closeInvoiceModal()">×</span>
  </div>
  
  <form id="invoiceForm" onsubmit="submitInvoice(event)">
    <div class="form-group">
      <label>تاريخ الفاتورة</label>
      <input type="date" required>
    </div>
    
    <div class="form-group">
      <label>العميل</label>
      <input type="text" placeholder="اسم العميل" required>
    </div>
    
    <div class="form-group">
      <label>رقم الفاتورة</label>
      <input type="text" required>
    </div>
    
    <div class="form-group">
      <label>وصف الخدمة/المنتج</label>
      <textarea rows="3" required></textarea>
    </div>
    
    <div class="form-group">
      <label>المبلغ</label>
      <input type="number" step="0.01" required>
    </div>
    
    <div class="form-group">
      <label>الضريبة (%)</label>
      <input type="number" value="15" min="0" max="100">
    </div>
    
    <div class="form-actions">
      <button type="submit" class="btn-submit">إصدار الفاتورة</button>
      <button type="button" class="btn-cancel" onclick="closeInvoiceModal()">إلغاء</button>
    </div>
  </form>
</div>

<div class="footer">
  جميع الحقوق محفوظة © 2024 | تصميم وبرمجة 
  <a href="https://www.shoppingtopex.com" target="_blank">شركة شوبنق تابكس</a>
  | <span dir="ltr">777007199</span>
</div>

<!-- Add scroll-to-top button before closing body tag -->
<button class="scroll-to-top" id="scrollTopBtn" onclick="scrollToTop()">
  <svg viewBox="0 0 24 24" width="24" height="24">
    <path d="M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z" fill="currentColor"/>
  </svg>
</button>

<script>
let sidebarOpen = false;

function toggleNav() {
  if (sidebarOpen) {
    closeNav();
  } else {
    openNav();
  }
}

function openNav() {
  document.getElementById("mySidebar").style.width = "250px";
  document.getElementById("mainContent").classList.add("shifted");
  sidebarOpen = true;
}

function closeNav() {
  document.getElementById("mySidebar").style.width = "0";
  document.getElementById("mainContent").classList.remove("shifted");
  sidebarOpen = false;
}

function toggleSubmenu(element) {
  const menuItem = element.parentElement;
  const wasActive = menuItem.classList.contains('active');
  
  document.querySelectorAll('.menu-item').forEach(item => {
    item.classList.remove('active');
  });
  
  if (!wasActive) {
    menuItem.classList.add('active');
  }
}

// Add smooth scroll handling
document.addEventListener('DOMContentLoaded', function() {
  const scrollBtn = document.getElementById('scrollTopBtn');
  
  // Handle scroll button visibility
  window.addEventListener('scroll', function() {
    try {
      if (window.scrollY > 300) {
        scrollBtn.classList.add('visible');
      } else {
        scrollBtn.classList.remove('visible');
      }
    } catch (error) {
      console.error('Scroll handling error:', error);
    }
  });
});

// Scroll to top function
function scrollToTop() {
  try {
    window.scrollTo({
      top: 0,
      behavior: 'smooth'
    });
  } catch (error) {
    console.error('Error scrolling to top:', error);
    // Fallback
    window.scrollTo(0, 0);
  }
}

// Add global error handler
window.addEventListener('unhandledrejection', function(event) {
  console.error('Unhandled Promise Rejection:', event.reason);
});

// Add error handler for external resources
document.addEventListener('error', handleResourceError, true);

function handleResourceError(event) {
  console.error('Resource failed to load:', event.target.src || event.target.href);
  // Handle resource loading errors gracefully
}

// Add API error handling wrapper
async function safeApiCall(apiFunction) {
  try {
    return await apiFunction();
  } catch (error) {
    console.error('API Error:', error);
    // Handle API errors gracefully
    return null;
  }
}

// Fix AI cost calculation
function calculateAICosts() {
  try {
    const details = document.getElementById('projectDetails').value;
    if (!details) {
      alert('الرجاء إدخال تفاصيل المشروع');
      return;
    }
    
    const button = event.target;
    button.disabled = true;
    button.innerHTML = 'جاري الحساب...';

    setTimeout(() => {
      button.disabled = false;
      button.innerHTML = 'حساب التكاليف';
      closeAIModal();
    }, 2000);
  } catch (error) {
    console.error('Error in AI calculation:', error);
    alert('حدث خطأ أثناء الحساب');
  }
}

// Add notification functionality
let notifications = document.querySelectorAll('.notification-item');
notifications.forEach(notification => {
  notification.addEventListener('click', function() {
    if (!this.classList.contains('read')) {
      this.classList.add('read');
      this.style.opacity = '0.7';
      updateNotificationCount();
    }
  });
});

function updateNotificationCount() {
  const unreadCount = document.querySelectorAll('.notification-item:not(.read)').length;
  document.getElementById('notification-count').textContent = unreadCount;
}

// Add notification toggling function
function toggleNotifications() {
  const panel = document.querySelector('.notification-panel');
  const toggle = document.querySelector('.notifications-toggle');
  
  if (panel.classList.contains('hidden')) {
    panel.classList.remove('hidden');
    toggle.style.display = 'none';
  } else {
    panel.classList.add('hidden'); 
    setTimeout(() => {
      toggle.style.display = 'block';
    }, 300); // Match transition duration
  }
}

// Add AI modal functions
function openAIModal() {
  document.getElementById('aiModal').style.display = 'block';
  document.getElementById('aiModalOverlay').style.display = 'block';
}

function closeAIModal() {
  document.getElementById('aiModal').style.display = 'none';
  document.getElementById('aiModalOverlay').style.display = 'none';
}

// Add missing functions to close modals
function closeJournalModal() {
  try {
    document.getElementById('journalEntryModal').style.display = 'none';
    document.getElementById('journalEntryOverlay').style.display = 'none';
  } catch (error) {
    console.error('Error closing journal modal:', error);
  }
}

function closeInvoiceModal() {
  try {
    document.getElementById('invoiceModal').style.display = 'none';
    document.getElementById('invoiceModalOverlay').style.display = 'none';
  } catch (error) {
    console.error('Error closing invoice modal:', error);
  }
}

// Add modal close handling for escape key
document.addEventListener('keydown', function(event) {
  if (event.key === 'Escape') {
    closeJournalModal();
    closeInvoiceModal();
    closeAIModal();
  }
});

// Add overlay click handling for modals
document.getElementById('journalEntryOverlay').addEventListener('click', closeJournalModal);
document.getElementById('invoiceModalOverlay').addEventListener('click', closeInvoiceModal);
document.getElementById('aiModalOverlay').addEventListener('click', closeAIModal);

// Fix modal functions
function openQuickAction(type) {
  try {
    switch(type) {
      case 'journal':
        openJournalModal();
        break;
      case 'invoice':
        openInvoiceModal();
        break;
      case 'payment':
        // Add payment modal handling
        break;
      case 'expense':
        // Add expense modal handling
        break;
      default:
        console.warn('Unknown quick action type:', type);
    }
  } catch (error) {
    console.error('Error in quick action:', error);
  }
}

function openJournalModal() {
  try {
    document.getElementById('journalEntryModal').style.display = 'block';
    document.getElementById('journalEntryOverlay').style.display = 'block';
  } catch (error) {
    console.error('Error opening journal modal:', error);
  }
}

function openInvoiceModal() {
  try {
    document.getElementById('invoiceModal').style.display = 'block';
    document.getElementById('invoiceModalOverlay').style.display = 'block';
  } catch (error) {
    console.error('Error opening invoice modal:', error);
  }
}

// Form submission error handling
function submitJournalEntry(event) {
  try {
    event.preventDefault();
    const form = event.target;
    const submitBtn = form.querySelector('.btn-submit');
    
    submitBtn.disabled = true;
    submitBtn.innerHTML = 'جاري الحفظ...';

    setTimeout(() => {
      submitBtn.disabled = false;
      submitBtn.innerHTML = 'حفظ القيد';
      form.reset();
      closeJournalModal();
    }, 1500);
  } catch (error) {
    console.error('Error submitting journal entry:', error);
    alert('حدث خطأ أثناء حفظ القيد');
  }
}

function submitInvoice(event) {
  try {
    event.preventDefault();
    const form = event.target;
    const submitBtn = form.querySelector('.btn-submit');
    
    submitBtn.disabled = true;
    submitBtn.innerHTML = 'جاري الإصدار...';

    setTimeout(() => {
      submitBtn.disabled = false;
      submitBtn.innerHTML = 'إصدار الفاتورة';
      form.reset();
      closeInvoiceModal();
    }, 1500);
  } catch (error) {
    console.error('Error submitting invoice:', error);
    alert('حدث خطأ أثناء إصدار الفاتورة');
  }
}

// Initialize error handling
document.addEventListener('error', function(e) {
  console.error('Error loading resource:', e);
});

// KPI trend indicators
function updateKPITrends() {
  const kpiCards = document.querySelectorAll('.kpi-card');
  kpiCards.forEach(card => {
    const trend = document.createElement('div');
    trend.className = 'kpi-trend';
    trend.innerHTML = `
      <svg width="16" height="16" viewBox="0 0 16 16" fill="#2ecc71">
        <path d="M8 4l4 4H4z"/>
      </svg>
      <span style="color: #2ecc71">+5.2%</span>
    `;
    card.appendChild(trend);
  });
}

document.addEventListener('DOMContentLoaded', function() {
  updateKPITrends();
  
  // Charts initialization
  // Cost Distribution Pie Chart
  const costDistribution = new Chart(document.getElementById('costDistribution'), {
    type: 'pie',
    data: {
      labels: ['المواد', 'العمالة', 'التكاليف غير المباشرة'],
      datasets: [{
        data: [45, 30, 25],
        backgroundColor: ['#f4a261', '#e9c46a', '#ffd7ba'] /* Different shades of orange */
      }]
    },
    options: {
      responsive: true,
      plugins: {
        title: {
          display: true,
          text: 'توزيع التكاليف',
          font: {
            size: 16,
            family: 'Cairo'
          }
        }
      }
    }
  });

  // Cost & Revenue Trend Line Chart
  const costRevenueTrend = new Chart(document.getElementById('costRevenueTrend'), {
    type: 'line',
    data: {
      labels: ['يناير', 'فبراير', 'مارس', 'أبريل', 'مايو', 'يونيو'],
      datasets: [{
        label: 'التكاليف',
        data: [650000, 700000, 850000, 900000, 950000, 1000000],
        borderColor: '#f4a261', /* Light orange for costs */
        fill: false
      }, {
        label: 'الإيرادات',
        data: [800000, 950000, 1100000, 1250000, 1400000, 1600000],
        borderColor: '#e9c46a', /* Lighter orange for revenue */
        fill: false
      }]
    },
    options: {
      responsive: true,
      plugins: {
        title: {
          display: true,
          text: 'تطور التكاليف والإيرادات',
          font: {
            size: 16,
            family: 'Cairo'
          }
        }
      }
    }
  });
});

// Initialize error handling
document.addEventListener('error', function(e) {
  console.error('Error loading resource:', e);
});
</script>
</body>
</html>